<div class="icon-list">
  <div>
    <div class="top-icon-set">
      <mat-icon class="hamburger-icon">menu</mat-icon>
      <mat-icon class="chevron-icon">chevron_left</mat-icon>
    </div>
    <div class="bottom-icon-set" fxLayoutAlign.lt-sm="flex-start" fxLayoutAlign="space-around">
      <mat-icon (click)="ShowLocationSearchBarClicked()">search</mat-icon>
      <mat-icon (click)="ActivateSaveMapDialog(map)">add</mat-icon>
      <mat-icon mat-button [matMenuTriggerFor]="layerMenu">layers</mat-icon>
    </div>
  </div>
</div>

<div [hidden]="!ShowSearchBar" id="search-bar">

  <div [hidden]="SearchMethod !== 'Google Locations'">
    <input placeholder="search for Google location" autocorrect="off" autocapitalize="off" spellcheck="off" type="text"
      #search [formControl]="SearchControl">
  </div>

  <form [hidden]="SearchMethod !== 'Custom Markers'">
    <input type="text" placeholder="search for custom location" aria-label="Assignee" [formControl]="CustomLocationControl"
      [matAutocomplete]="auto">
    <mat-autocomplete #auto="matAutocomplete" [displayWith]="displayFn">
      <mat-option (click)="DropdownItemChosen(location)" *ngFor="let location of FilteredLocations | async"
        [value]="location">
        <span><img class="dropdown-marker-image" src="{{location.iconImageObject.url}}"></span>
        <span class="dropdown-marker-title-text">{{ location.title }}</span>&nbsp;
        <span class="dropdown-marker-location-text">{{ location.town }}, {{ location.country }}</span>
      </mat-option>
    </mat-autocomplete>
  </form>

  <div class="search-method-radio-group">
    <mat-radio-group [(ngModel)]="SearchMethod">
      <mat-radio-button *ngFor="let method of SearchMethods" [value]="method">
        {{method}}
      </mat-radio-button>
    </mat-radio-group>
  </div>

</div>
<agm-map (mapReady)="OnMapReady($event)" [mapTypeId]="CurrentMapViewType" (boundsChange)="BoundsChange($event)" #map
  [latitude]="_currentMapModel.origin.lat" [longitude]="_currentMapModel.origin.lng" [title]="_currentMapModel.title"
  [zoom]="_currentMapModel.zoom" (mapDblClick)="OnMapDoubleClicked($event)" (mapClick)="OnChoseLocation($event)"
  [usePanning]="true">
  <!-- <div *ngFor="let marker of _currentMapModel.locationList"> -->
  <div *ngFor="let marker of CurrentlyActiveLocations">
    <agm-marker [latitude]="marker.lat" [longitude]="marker.lng" [title]="marker.title"
      [iconUrl]="marker.iconImageObject" (markerClick)="DisplayMarkerInfo(marker)">
    </agm-marker>
  </div>
  <!-- </div> -->
</agm-map>
<span>Current Map: {{_currentMapModel.title}}</span>

<!-- the menu for the map layers button -->
<mat-menu #layerMenu="matMenu" id="layer-menu">
  <mat-radio-group [(ngModel)]="CurrentMapViewType">
    <mat-radio-button (click)="$event.stopPropagation()" *ngFor="let view of MapViewTypes" [value]="view.value">
      {{view.display}}</mat-radio-button>
  </mat-radio-group>
  <mat-divider></mat-divider>
  <mat-checkbox (click)="$event.stopPropagation()" (change)="LayerClicked($event)" [checked]="PrimaryChecked"
    matTooltip="The markers on your main map... Add markers to this map to be saved." matTooltipPosition="before">
    {{_currentMapModel.title}} (Primary)</mat-checkbox>
  <mat-divider></mat-divider>
  <mat-checkbox id="map_id_{{map.id}}" (click)="$event.stopPropagation()" [checked]="SecondaryChecked"
    (change)="LayerClicked($event, map)" *ngFor="let map of SecondaryMaps">{{ map.title }}
  </mat-checkbox>
</mat-menu>